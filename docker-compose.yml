version: 3
services:
  gatling:
    build: ./gatling
    restart: always
    stdin_open: true
    tty: true
    volumes:
      - ./gatling/results:/gatling/results:cached
      - ./gatling/simulations:/gatling/user-files/simulations:cached
      - ./gatling/logback.xml:/gatling/conf/logback.xml:cached
    environment:
      - baseUrl=https://localhost:8082
      - thread=1
      - time=1
  nginx:
    image: nginx
    restart: always
    volumes:
      - ./gatling/results:/usr/share/nginx/html
      - ./nginx/default.conf:/etc/nginx/conf.d/default.conf
    ports:
      - "80:80"
  mmock:
    image: jordimartin/mmock
    volumes:
      - ./mmock/config:/config
    ports:
      - "8082:8082"
      - "8083:8083"

